WITH MINSAL AS (
SELECT DISTINCT
S.EMP_NUM,
MIN(S.SAL_FROM) AS MIN_SAL_DATE
FROM
LGSALARY_HISTORY S
GROUP BY
S.EMP_NUM
)

SELECT DISTINCT
E.EMP_NUM,
E.EMP_LNAME,
E.EMP_FNAME,
S.SAL_AMOUNT AS SAL_AMOUNT
FROM
LGEMPLOYEE E
JOIN LGSALARY_HISTORY S ON S.EMP_NUM = E.EMP_NUM
LEFT JOIN MINSAL ON S.EMP_NUM = MINSAL.EMP_NUM
WHERE
MINSAL.MIN_SAL_DATE = S.SAL_FROM
ORDER BY
E.EMP_NUM;
