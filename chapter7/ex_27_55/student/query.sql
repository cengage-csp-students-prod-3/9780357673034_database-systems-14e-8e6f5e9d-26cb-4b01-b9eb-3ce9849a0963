SELECT DISTINCT
E.EMP_NUM,
E.EMP_LNAME,
E.EMP_FNAME,
MAX(S.SAL_AMOUNT) AS SAL_AMOUNT
FROM
LGEMPLOYEE E
JOIN 
LGSALARY_HISTORY S
ON
S.EMP_NUM = E.EMP_NUM
WHERE
E.DEPT_NUM = 300
AND S.SAL_END IS NULL
GROUP BY
E.EMP_NUM,
E.EMP_FNAME,
E.EMP_LNAME
ORDER BY 
SAL_AMOUNT DESC, E.EMP_NUM;
