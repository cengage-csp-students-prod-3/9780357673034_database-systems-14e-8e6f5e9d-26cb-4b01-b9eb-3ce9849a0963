SELECT

  EM.EMP_FNAME AS MNG_FNAME,
  EM.EMP_LNAME AS MNG_LNAME,
  D.DEPT_NAME,
  D.DEPT_PHONE,
  ES.EMP_FNAME AS EMP_FNAME,
  ES.EMP_LNAME AS EMP_LNAME,
  C.CUST_FNAME AS CUST_FNAME,
  C.CUST_LNAME AS CUST_LNAME,
  I.INV_DATE,
  I.INV_TOTAL
FROM
  LGCUSTOMER AS C
JOIN
  LGINVOICE AS I
ON
  C.CUST_CODE = I.CUST_CODE
JOIN
  LGEMPLOYEE AS ES -- Alias for the employee who made the sale
ON
  I.EMPLOYEE_ID = ES.EMP_NUM -- CORRECTED: Using I.EMPLOYEE_ID
JOIN
  LGDEPARTMENT AS D
ON
  ES.DEPT_NUM = D.DEPT_NUM
JOIN
  LGEMPLOYEE AS EM -- Alias for the department manager
ON
  D.EMP_NUM = EM.EMP_NUM
WHERE
  C.CUST_LNAME = 'Hagan'
  AND I.INV_DATE = '2021-05-18';