
SELECT
C.CUS_CODE,
ROUND(COUNT(I.INV_NUMBER),0) AS "NUMBER OF INVOICES", 
SUM(ROUND(L.LINE_PRICE * L.LINE_UNITS,2)) AS "TOTAL CUSTOMER PURCHASES"
FROM
CUSTOMER C 
JOIN      
INVOICE I
ON
C.CUS_CODE = I.CUS_CODE
JOIN
Ch07_SaleCoLINE L
ON 
L.INV_NUMBER = I.INV_NUMBER
JOIN
PRODUCT P
ON
L.P_Code = P.P_CODE
GROUP BY
C.CUS_CODE
ORDER BY 
C.CUS_CODE; 