SELECT
    BOOK_NUM,
    BOOK_TITLE,
    BOOK_SUBJECT,
    ROUND(AVG(BOOK_COST) OVER (PARTITION BY BOOK_SUBJECT), 2) AS AVGCOST,
    ROUND(BOOK_COST - AVG(BOOK_COST) OVER (PARTITION BY BOOK_SUBJECT), 2) AS Difference
FROM
    BOOK
ORDER BY
    BOOK_TITLE ASC;